<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>monday work management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&family=Noto+Sans+Hebrew:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <!-- ==================== AUTH SCREEN (Task 4) ==================== -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-logo">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
                    <circle cx="6" cy="18" r="4" fill="#ff3d57"/>
                    <circle cx="12" cy="8" r="4" fill="#ffcb00"/>
                    <circle cx="18" cy="18" r="4" fill="#00ca72"/>
                </svg>
                <div>
                    <span class="auth-logo-text">monday</span>
                    <span class="auth-logo-suffix">work management</span>
                </div>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form-container">
                <h2 class="auth-title">Log in to your account</h2>
                <form onsubmit="handleLogin(event)">
                    <div class="auth-field">
                        <label>Email</label>
                        <input type="email" id="loginEmail" placeholder="name@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label>Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter your password" required autocomplete="current-password">
                    </div>
                    <div id="loginError" class="auth-error"></div>
                    <button type="submit" class="auth-btn auth-btn-primary">Log in</button>
                </form>

                <div class="auth-divider"><span>or</span></div>

                <button class="auth-btn auth-btn-google" onclick="handleGoogleLogin()">
                    <svg width="20" height="20" viewBox="0 0 48 48"><path fill="#4285F4" d="M44.5 20H24v8.5h11.7C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"/><path fill="#34A853" d="M6.3 14.7l7 5.1C15 16.2 19.2 13 24 13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 16.3 2 9.7 6.6 6.3 14.7z"/><path fill="#FBBC05" d="M24 46c5.4 0 10.3-1.8 14.1-4.9l-6.5-5.5C29.5 37.5 26.9 38.5 24 38.5c-6 0-11.1-4-12.9-9.5l-7 5.4C7.7 42.2 15.2 46 24 46z"/><path fill="#EA4335" d="M44.5 20H24v8.5h11.7c-1 3.2-3.2 5.8-6.1 7.5l6.5 5.5C40.9 37.2 46 31.3 46 24c0-1.3-.2-2.7-.5-4z"/></svg>
                    Continue with Google
                </button>

                <button class="auth-btn auth-btn-facebook" onclick="handleFacebookLogin()">
                    <svg width="20" height="20" viewBox="0 0 48 48"><path fill="#1877F2" d="M48 24C48 10.7 37.3 0 24 0S0 10.7 0 24c0 12 8.8 21.9 20.3 23.7V30.9h-6.1V24h6.1v-5.3c0-6 3.6-9.3 9-9.3 2.6 0 5.4.5 5.4.5v5.9h-3c-3 0-3.9 1.9-3.9 3.8V24h6.6l-1.1 6.9h-5.5v16.8C39.2 45.9 48 36 48 24z"/></svg>
                    Continue with Facebook
                </button>

                <div class="auth-links">
                    <a href="#" onclick="showForgotPasswordForm()">Forgot password?</a>
                    <span>Don't have an account? <a href="#" onclick="showRegisterForm()">Sign up</a></span>
                </div>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="auth-form-container" style="display:none">
                <h2 class="auth-title">Create your account</h2>
                <p class="auth-subtitle">First user becomes Super Admin</p>
                <form onsubmit="handleRegister(event)">
                    <div class="auth-field">
                        <label>Full Name</label>
                        <input type="text" id="regFullName" placeholder="Enter your full name" required autocomplete="name">
                    </div>
                    <div class="auth-field">
                        <label>Email</label>
                        <input type="email" id="regEmail" placeholder="name@company.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label>Password</label>
                        <input type="password" id="regPassword" placeholder="At least 6 characters" required minlength="6" autocomplete="new-password">
                    </div>
                    <div class="auth-field">
                        <label>Confirm Password</label>
                        <input type="password" id="regConfirmPassword" placeholder="Confirm your password" required autocomplete="new-password">
                    </div>
                    <div id="regError" class="auth-error"></div>
                    <button type="submit" class="auth-btn auth-btn-primary">Create account</button>
                </form>

                <div class="auth-divider"><span>or</span></div>

                <button class="auth-btn auth-btn-google" onclick="handleGoogleLogin()">
                    <svg width="20" height="20" viewBox="0 0 48 48"><path fill="#4285F4" d="M44.5 20H24v8.5h11.7C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"/></svg>
                    Sign up with Google
                </button>

                <button class="auth-btn auth-btn-facebook" onclick="handleFacebookLogin()">
                    <svg width="20" height="20" viewBox="0 0 48 48"><path fill="#1877F2" d="M48 24C48 10.7 37.3 0 24 0S0 10.7 0 24c0 12 8.8 21.9 20.3 23.7V30.9h-6.1V24h6.1v-5.3c0-6 3.6-9.3 9-9.3 2.6 0 5.4.5 5.4.5v5.9h-3c-3 0-3.9 1.9-3.9 3.8V24h6.6l-1.1 6.9h-5.5v16.8C39.2 45.9 48 36 48 24z"/></svg>
                    Sign up with Facebook
                </button>

                <div class="auth-links">
                    <span>Already have an account? <a href="#" onclick="showLoginForm()">Log in</a></span>
                </div>
            </div>

            <!-- Forgot Password Form -->
            <div id="forgotPasswordForm" class="auth-form-container" style="display:none">
                <h2 class="auth-title">Reset your password</h2>
                <p class="auth-subtitle">Enter your email and we'll send you a reset link</p>
                <form onsubmit="handleForgotPassword(event)">
                    <div class="auth-field">
                        <label>Email</label>
                        <input type="email" id="forgotEmail" placeholder="name@company.com" required>
                    </div>
                    <div id="forgotError" class="auth-error"></div>
                    <div id="forgotSuccess" class="auth-success"></div>
                    <button type="submit" class="auth-btn auth-btn-primary">Send reset link</button>
                </form>
                <div class="auth-links">
                    <a href="#" onclick="showLoginForm()">Back to login</a>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MAIN APP ==================== -->
    <div id="appMain" style="display:none;flex-direction:column;height:100vh;">

        <!-- Top Header Bar -->
        <header class="top-header">
            <div class="header-right">
                <div class="monday-logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <circle cx="6" cy="18" r="4" fill="#ff3d57"/>
                        <circle cx="12" cy="8" r="4" fill="#ffcb00"/>
                        <circle cx="18" cy="18" r="4" fill="#00ca72"/>
                    </svg>
                    <span class="logo-text">monday</span>
                    <span class="logo-suffix">work management</span>
                </div>
                <div class="header-divider"></div>
                <button class="header-btn see-plans-btn">
                    <span class="material-icons-outlined" style="font-size:16px">star</span>
                    See plans
                </button>
            </div>
            <div class="header-left">
                <button class="header-icon-btn"><span class="material-icons-outlined">notifications</span></button>
                <button class="header-icon-btn"><span class="material-icons-outlined">inbox</span></button>
                <button class="header-icon-btn" onclick="openInviteModal()" title="Invite people"><span class="material-icons-outlined">people</span></button>
                <button class="header-icon-btn"><span class="material-icons-outlined">cloud_upload</span></button>
                <button class="header-icon-btn"><span class="material-icons-outlined">search</span></button>
                <button class="header-icon-btn"><span class="material-icons-outlined">help_outline</span></button>
                <button class="header-icon-btn"><span class="material-icons-outlined">favorite_border</span></button>
                <button class="header-icon-btn"><span class="material-icons-outlined">apps</span></button>
                <div class="user-avatar header-avatar user-avatar-initials" title="Click to see options" onclick="showUserMenu(event)">MM</div>
            </div>
        </header>

        <div class="app-container">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <nav class="sidebar-nav">
                    <a href="#" class="sidebar-item"><span class="material-icons-outlined">home</span><span class="sidebar-label">Home</span></a>
                    <a href="#" class="sidebar-item"><span class="material-icons-outlined">task_alt</span><span class="sidebar-label">My work</span></a>
                    <a href="#" class="sidebar-item"><span class="material-icons-outlined">schedule</span><span class="sidebar-label">Recents</span></a>
                    <a href="#" class="sidebar-item"><span class="material-icons-outlined">more_horiz</span><span class="sidebar-label">More</span></a>
                </nav>
                <div class="sidebar-section">
                    <div class="sidebar-section-header"><span>monday AI</span><span class="material-icons-outlined" style="font-size:16px">expand_more</span></div>
                    <a href="#" class="sidebar-item sub-item"><span class="material-icons-outlined">auto_awesome</span><span class="sidebar-label">AI Sidekick</span></a>
                    <a href="#" class="sidebar-item sub-item"><span class="material-icons-outlined">brush</span><span class="sidebar-label">Vibe</span></a>
                    <a href="#" class="sidebar-item sub-item"><span class="material-icons-outlined">account_tree</span><span class="sidebar-label">AI Workflows</span></a>
                    <a href="#" class="sidebar-item sub-item"><span class="material-icons-outlined">smart_toy</span><span class="sidebar-label">AI Agents</span></a>
                    <a href="#" class="sidebar-item sub-item"><span class="material-icons-outlined">edit_note</span><span class="sidebar-label">AI Notetaker</span></a>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-header"><span>Favorites</span><span class="material-icons-outlined" style="font-size:16px">expand_more</span></div>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-section-header">
                        <span>Workspaces</span>
                        <div class="sidebar-section-actions">
                            <span class="material-icons-outlined" style="font-size:16px">more_horiz</span>
                            <span class="material-icons-outlined" style="font-size:16px">search</span>
                        </div>
                    </div>
                    <div class="workspace-selector">
                        <div class="workspace-icon">M</div>
                        <span>Main workspa...</span>
                        <button class="add-workspace-btn">+</button>
                    </div>
                    <div class="sidebar-project-list">
                        <a href="#" class="sidebar-item project-item active" data-board="board1">
                            <span class="material-icons-outlined">table_chart</span>
                            <span class="sidebar-label" dir="rtl">&#x5E0;&#x5D9;&#x5E1;&#x5D9;&#x5D5;&#x5DF;</span>
                        </a>
                        <a href="#" class="sidebar-item project-item" data-board="board2">
                            <span class="material-icons-outlined">dashboard</span>
                            <span class="sidebar-label">Dashboard and reporting</span>
                        </a>
                    </div>
                </div>
                <!-- User info at bottom -->
                <div class="sidebar-user-info">
                    <div class="user-avatar user-avatar-initials" style="width:28px;height:28px;font-size:10px;">MM</div>
                    <div class="sidebar-user-details">
                        <span id="userDisplayName" class="sidebar-label"></span>
                        <span class="sidebar-user-role" id="userRoleBadge"></span>
                    </div>
                    <button class="sidebar-logout-btn" onclick="logout()" title="Logout">
                        <span class="material-icons-outlined" style="font-size:18px">logout</span>
                    </button>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <div class="board-header">
                    <div class="board-title-row">
                        <h1 class="board-title" dir="rtl">&#x5E0;&#x5D9;&#x5E1;&#x5D9;&#x5D5;&#x5DF;</h1>
                        <span class="material-icons-outlined board-title-dropdown">expand_more</span>
                    </div>
                    <div class="board-actions">
                        <button class="board-action-btn sidekick-btn"><span class="material-icons-outlined">auto_awesome</span>Sidekick</button>
                        <button class="board-action-btn ai-btn"><span class="material-icons-outlined">psychology</span>AI suggestions<span class="badge-new">New</span></button>
                        <button class="board-action-btn"><span class="material-icons-outlined">integration_instructions</span>Integrate</button>
                        <button class="board-action-btn"><span class="material-icons-outlined">bolt</span>Automate</button>
                        <div class="board-action-divider"></div>
                        <div class="user-avatar board-avatar user-avatar-initials">MM</div>
                        <span class="invite-text invite-trigger" onclick="openInviteModal()" style="cursor:pointer">Invite / <span id="inviteCount">1</span></span>
                        <button class="header-icon-btn"><span class="material-icons-outlined">link</span></button>
                        <button class="header-icon-btn"><span class="material-icons-outlined">more_horiz</span></button>
                    </div>
                </div>
                <div class="view-tabs">
                    <div class="tab active">Main table<span class="material-icons-outlined" style="font-size:14px;margin-right:4px">more_horiz</span></div>
                    <button class="add-tab-btn">+</button>
                </div>
                <div class="toolbar">
                    <button class="toolbar-btn primary-btn" id="newTaskBtn">New task<span class="material-icons-outlined" style="font-size:16px">expand_more</span></button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">search</span>Search</button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">person</span>Person</button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">filter_list</span>Filter<span class="material-icons-outlined" style="font-size:16px">expand_more</span></button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">swap_vert</span>Sort</button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">visibility_off</span>Hide</button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">view_column</span>Group by</button>
                    <button class="toolbar-btn"><span class="material-icons-outlined">more_horiz</span></button>
                </div>
                <div class="table-content" id="tableContent"></div>
            </main>
        </div>

        <!-- ===== FLOATING BAR (Task 2 & 3) ===== -->
        <div class="floating-bar" id="floatingBar">
            <div class="floating-bar-inner">
                <span class="floating-bar-count" id="floatingBarCount">0 Tasks selected</span>
                <div class="floating-bar-actions">
                    <button class="floating-btn" onclick="floatingBarDuplicate()">
                        <span class="material-icons-outlined">content_copy</span>Duplicate
                    </button>
                    <button class="floating-btn" onclick="floatingBarExportCSV()">
                        <span class="material-icons-outlined">download</span>Export CSV
                    </button>
                    <button class="floating-btn" onclick="floatingBarExportExcel()">
                        <span class="material-icons-outlined">table_view</span>Export Excel
                    </button>
                    <button class="floating-btn" onclick="floatingBarArchive()">
                        <span class="material-icons-outlined">archive</span>Archive
                    </button>
                    <button class="floating-btn floating-btn-danger" onclick="floatingBarDelete()">
                        <span class="material-icons-outlined">delete</span>Delete
                    </button>
                    <button class="floating-btn floating-btn-disabled" disabled title="Coming soon">
                        <span class="material-icons-outlined">open_with</span>Move
                    </button>
                    <button class="floating-btn floating-btn-disabled" disabled title="Coming soon">
                        <span class="material-icons-outlined">swap_horiz</span>Convert
                    </button>
                </div>
                <button class="floating-bar-close" onclick="clearSelection()">
                    <span class="material-icons-outlined">close</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ===== TASK DETAIL MODAL ===== -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"></h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group"><label>Task Name</label><input type="text" id="modalTaskName" class="form-input"></div>
                <div class="form-row">
                    <div class="form-group"><label>Status</label><select id="modalStatus" class="form-input"></select></div>
                    <div class="form-group"><label>Priority</label>
                        <select id="modalPriority" class="form-input">
                            <option value="">-</option><option value="low">Low</option><option value="medium">Medium</option>
                            <option value="high">High</option><option value="critical">Critical</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Due Date</label><input type="date" id="modalDueDate" class="form-input"></div>
                    <div class="form-group"><label>Budget</label><input type="number" id="modalBudget" class="form-input" min="0"></div>
                </div>
                <div class="form-group"><label>Notes</label><textarea id="modalNotes" class="form-input" rows="3"></textarea></div>
                <div class="form-row">
                    <div class="form-group"><label>Timeline Start</label><input type="date" id="modalTimelineStart" class="form-input"></div>
                    <div class="form-group"><label>Timeline End</label><input type="date" id="modalTimelineEnd" class="form-input"></div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn save-btn" onclick="saveTaskFromModal()">Save</button>
                    <button class="modal-btn cancel-btn" onclick="closeModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== INVITE MODAL (Task 5) ===== -->
    <div class="modal-overlay" id="inviteModal">
        <div class="modal-content invite-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Invite to work management</h2>
                <button class="modal-close" onclick="closeInviteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="invite-row">
                    <span class="invite-label">Invite with email</span>
                    <span class="invite-from">
                        Invite from
                        <button class="invite-google-btn" onclick="handleGoogleLogin()">
                            <svg width="16" height="16" viewBox="0 0 48 48"><path fill="#4285F4" d="M44.5 20H24v8.5h11.7C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"/></svg>
                            Google workspace
                        </button>
                    </span>
                </div>
                <form onsubmit="handleInvite(event)">
                    <div class="invite-input-row">
                        <div class="invite-email-wrap">
                            <input type="text" id="inviteEmail" class="form-input" placeholder="Name@example.com, Name@example.com ...">
                        </div>
                        <select id="inviteRole" class="form-input invite-role-select">
                            <option value="admin">Admin</option>
                            <option value="member" selected>Member</option>
                            <option value="viewer">Viewer</option>
                        </select>
                    </div>
                    <div class="invite-role-descriptions">
                        <div class="invite-role-desc" data-role="admin"><strong>Admin</strong><br>Manage users and settings</div>
                        <div class="invite-role-desc active" data-role="member"><strong>Member</strong><br>Create, edit and collaborate</div>
                        <div class="invite-role-desc" data-role="viewer"><strong>Viewer</strong><br>View only, no edits (free)</div>
                    </div>
                    <div class="auth-field" style="margin-top:16px">
                        <label>Write a message (optional)</label>
                        <textarea id="inviteMessage" class="form-input" rows="2" placeholder="Add context for new members"></textarea>
                    </div>
                    <div id="inviteError" class="auth-error"></div>
                    <div id="inviteSuccess" class="auth-success"></div>
                    <div class="invite-actions">
                        <button type="button" class="modal-btn cancel-btn" onclick="generateInviteLink()">
                            <span class="material-icons-outlined" style="font-size:16px">link</span>
                            Copy invite link
                        </button>
                        <button type="submit" class="modal-btn save-btn">Invite</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ===== USER MENU DROPDOWN ===== -->
    <div class="user-menu-dropdown" id="userMenuDropdown">
        <div class="user-menu-header">
            <div class="user-avatar user-avatar-initials" style="width:36px;height:36px;">MM</div>
            <div>
                <div class="user-menu-name" id="menuUserName"></div>
                <div class="user-menu-role" id="menuUserRole"></div>
            </div>
        </div>
        <div class="user-menu-divider"></div>
        <button class="user-menu-item" onclick="logout()">
            <span class="material-icons-outlined">logout</span>Log out
        </button>
    </div>

    <!-- Context menu for status/priority -->
    <div class="dropdown-menu" id="dropdownMenu"></div>

    <script src="app.js"></script>
</body>
</html>
